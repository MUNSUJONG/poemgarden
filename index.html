<script>
  async function makePayment() {
    try {
      const scopes = ['username', 'payments'];
      const user = await Pi.authenticate(scopes, function(payload) {
        console.log("인증된 사용자:", payload);
      });

      const payment = await Pi.createPayment({
        amount: 0.01,
        memo: "파이 감성정원 테스트 결제",
        metadata: { purpose: "test" }
      }, {
        onReadyForServerApproval: function(paymentId) {
          console.log("✅ 서버 승인 준비 완료:", paymentId);
        },
        onReadyForServerCompletion: function(paymentId, txid) {
          console.log("🎉 결제 완료 준비됨:", paymentId, txid);
        },
        onCancel: function(paymentId) {
          alert("❌ 사용자가 결제를 취소했습니다.");
        },
        onError: function(error, payment) {
          alert("⚠️ 결제 중 오류 발생: " + error);
        }
      });

      console.log("최종 결제 결과:", payment);
    } catch (error) {
      alert("결제 실패 또는 취소됨: " + error);
    }
  }
</script>
