
<!DOCTYPE html>
<html>
<head>
  <title>Pi 결제 테스트</title>
  <meta charset="UTF-8" />
  <script defer src="https://sdk.minepi.com/pi-sdk.js"></script>
</head>
<body>
  <h1>🌸 감성정원 테스트 결제</h1>
  <button id="payBtn">테스트 결제하기</button>

  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      try {
        const Pi = window.Pi;
        await Pi.init({
          version: "2.0",
          sandbox: true
        });

        document.getElementById("payBtn").addEventListener("click", async () => {
          alert("🔔 결제 시작!");

          const payment = await Pi.createPayment(
            {
              amount: 0.01,
              memo: "감성정원 테스트 결제",
              metadata: { note: "test" }
            },
            {
              onReadyForServerApproval: (paymentId) => {
                console.log("승인 대기:", paymentId);
              },
              onReadyForServerCompletion: (paymentId, txid) => {
                console.log("완료 대기:", paymentId, txid);
              },
              onCancel: (paymentId) => {
                alert("❌ 결제 취소됨");
              },
              onError: (error) => {
                alert("🚫 오류 발생: " + error.message);
              }
            }
          );

          await payment.approve();
        });
      } catch (err) {
        alert("🚨 Pi SDK 초기화 실패: " + err.message);
      }
    });
  </script>
</body>
</html>
