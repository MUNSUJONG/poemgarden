
<!-- ⚠️ 반드시 body 아래에 있어야 함 -->
<script src="https://sdk.minepi.com/pi-sdk.js"></script>
<script>
  // 전체 DOM이 로딩된 후 SDK 초기화
  document.addEventListener("DOMContentLoaded", function () {
    Pi.init({
      version: "2.0",
      sandbox: true  // 테스트넷
    });

    // 버튼이 SDK 초기화 이후에만 작동하게 연결
    document.getElementById("loginBtn").onclick = function () {
      Pi.authenticate(['username'], function(authResult) {
        alert("로그인 성공: " + JSON.stringify(authResult));
      }, function(error) {
        alert("로그인 실패: " + error);
      });
    };

    document.getElementById("payBtn").onclick = function () {
      Pi.createPayment({
        amount: 0.01,
        memo: "감성 메시지 결제",
        metadata: { type: "message", content: "🌸 감성 정원 메시지" },
      }, {
        onReadyForServerApproval: function(paymentId) {
          alert("승인 필요: " + paymentId);
        },
        onReadyForServerCompletion: function(paymentId, txid) {
          alert("결제 완료! TXID: " + txid);
        },
        onCancel: function(paymentId) {
          alert("결제 취소됨");
        },
        onError: function(error, paymentId) {
          alert("결제 실패: " + error);
        }
      });
    };
  });
</script>
